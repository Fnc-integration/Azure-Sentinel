{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## FortiNDR Cloud workbook\n---\n\nPlease use tab selector to switch between views of Suricata, Observation,and detections to view correlated charts and list tables."
      },
      "name": "text - 2"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "514047f6-4d61-4f59-9f79-6c22c20645c0",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Suricata",
            "subTarget": "Suricata",
            "style": "link"
          },
          {
            "id": "f20fabf1-3a44-417d-9e97-3d62d1990c8d",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Observation",
            "subTarget": "Observation",
            "style": "link"
          },
          {
            "id": "392a41e1-a18c-4a6d-8144-c51e27a8bf4e",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Detection",
            "subTarget": "Detection",
            "style": "link"
          }
        ]
      },
      "name": "links - 11"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Suricata charts and list tables"
            },
            "name": "text - 0"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "7b566fdf-c574-466d-8a25-eec9e314f560",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 1209600000
                  }
                },
                {
                  "id": "0ce88674-9bf5-4c52-8286-28d3cf030e18",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "query": "FncEventsSuricata_CL\n| summarize by alert_category_s\n| order by alert_category_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsSuricata_CL'\n| where Timestamp between ({TimeRange:start} .. {TimeRange:end})\n| where isempty('{Category}') or (AlertCategory == '{Category}')\n| summarize Count=count() by AlertCategory, bin(Timestamp, 1d)",
              "size": 0,
              "showAnalytics": true,
              "title": "FNC Suricata Chart",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart"
            },
            "name": "query - 2"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "5d5a54f3-6fca-4368-aea2-a2d0326daa62",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 2592000000
                  }
                },
                {
                  "id": "03cace3a-c0d6-4184-a1aa-346c67578b6b",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "query": "FncEventsSuricata_CL\n| summarize by alert_category_s\n| order by alert_category_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsSuricata_CL'\n| where  Timestamp between ({TimeRange:start} .. {TimeRange:end})\n| where isempty('{Category}') or (AlertCategory == '{Category}')\n| project TimeGenerated, DstIpEnrichmentsAnnotationsTags, SrcIpEnrichmentsAnnotationTags, HttpRefer, Intel, SrcIpEnrichmentsGeoSubdivision, SrcIpEnrichmentsGeoCity, SrcIpEnrichmentsAnnotationsApplications, SrcIpEnrichmentsAnnotationsEnvironments, SrcIpEnrichmentsAnnotationsLocation, HttpHostnameEnrichmentsIpEnrichmentsGeoCountry, HttpHostnameEnrichmentsIpEnrichmentsGeoSubdivision, HttpHostnameEnrichmentsIpEnrichmentsGeoCity,  HttpHostnameEnrichmentsIpEnrichmentsAsnAsn,  HttpHostnameEnrichmentsIpEnrichmentsAsnOrg, HttpHostnameEnrichmentsIpEnrichmentsAsnIsp, HttpHostnameEnrichmentsIpEnrichmentsAsnAsnOrg, HttpHostnameEnrichmentsIpEnrichmentsInternal, HttpHostnameEnrichmentsIpEnrichmentsGeoLocation, HttpRedirect, SrcIpEnrichmentsGeoCountry, SrcIpEnrichmentsAsnAsn, SrcIpEnrichmentsAsnOrg, SrcIpEnrichmentsAsnIsp, SrcIpEnrichmentsAsnAsnOrg, Timestamp, UUID, EventType, CustomerId, SensorId, Source, SrcIp, SrcIpEnrichmentsInternal, SrcPort, DesIp, DstIpEnrichmentsInternal, DstIpEnrichmentsGeoCountry, DstIpEnrichmentsGeoSubdevision, DstIpEnrichmentsGeoCity, DstIpEnrichmentsAsnAsn, DstIpEnrichmentsAsnOrg, DstIpEnrichmentsAsnIsp, DstIpEnrichmentsAsnAsnOrg, GeoDistance, Destport, Protoco, AlertSignatureId, AlertRev, AlertSignature, AlertCategory, AlertSeverity, HttpStatus, HttpProtoco, HttpUrl, HttpHostname,  HttpHostnameEnrichmentsDomainEnrichmentsDomainEntropy, HttpLength, HttpMethod, HttpContentType, HttpUserAgent, Payload, DstIpEnrichmentsAnnotationsApplications, DstIpEnrichmentsAnnotationsEnvironments, DstIpEnrichmentsAnnotationsLocations, Type",
              "size": 0,
              "showAnalytics": true,
              "title": "FNC Suricata List",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "exportToExcelOptions": "all",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "filter": true
              },
              "sortBy": [],
              "mapSettings": {
                "locInfo": "LatLong",
                "sizeSettings": "http_hostname_enrichments_ip_enrichments_asn_asn_d",
                "sizeAggregation": "Sum",
                "legendMetric": "http_hostname_enrichments_ip_enrichments_asn_asn_d",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "type": "heatmap",
                  "colorAggregation": "Sum",
                  "nodeColorField": "http_hostname_enrichments_ip_enrichments_asn_asn_d",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "name": "FNC Suricata List"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Suricata"
      },
      "name": "Suricata"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Observation charts and list tables"
            },
            "name": "text - 0"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "fcd15fc8-790a-448e-8a61-1a1ec5f70e05",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 2419200000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsObservation_CL'\n| where Timestamp between({TimeRange:start} .. {TimeRange:end})\n| summarize High = count(Confidence == 'high'), Moderate = count(Confidence == 'moderate'), Low = count(Confidence == 'low') by bin(Timestamp, 1d)",
              "size": 0,
              "showAnalytics": true,
              "title": "FNC Observation Chart",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart",
              "tileSettings": {
                "showBorder": false
              },
              "graphSettings": {
                "type": 0
              },
              "mapSettings": {
                "locInfo": "LatLong",
                "sizeSettings": "High",
                "sizeAggregation": "Sum",
                "legendMetric": "High",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "type": "heatmap",
                  "colorAggregation": "Sum",
                  "nodeColorField": "High",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "name": "query - 5"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "55ad269b-ead8-4f61-b429-669d632b53e1",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 604800000
                  }
                },
                {
                  "id": "9ff7f038-1fa5-4ac1-84cb-ef8c6e91a183",
                  "version": "KqlParameterItem/1.0",
                  "name": "Sensor_ID",
                  "type": 2,
                  "query": "FncEventsObservation_CL\n| summarize by sensor_id_s\n| order by sensor_id_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                },
                {
                  "id": "3e100d32-5ad3-4a4f-a486-f65be2c62101",
                  "version": "KqlParameterItem/1.0",
                  "name": "Confidence",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\n    {\"value\":\"high\", \"label\":\"High\"},\n    {\"value\":\"moderate\", \"label\":\"Moderate\"},\n    {\"value\":\"low\", \"label\":\"Low\"}\n]",
                  "defaultValue": "value::all"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsObservation_CL'\n| where Timestamp between({TimeRange:start} .. {TimeRange:end})\n| where Confidence in ({Confidence})\n| where isempty('{Sensor_ID}') or (SensorId == '{Sensor_ID}')\n| project TimeGenerated, Category, Intel, DstIpEnrichmentsGeoCountry,  DstIpEnrichmentsGeoSubdivision, DstIpEnrichmentsGeoCity, DstIpEnrichmentsAsnAsn, DstIpEnrichmentsAsnOrg,  DstIpEnrichmentsAsnIsp, DstIpEnrichmentsAsnAsnOrg, Timestamp, UUId, EventType, CustomerId, SensorId, Source, EvidenceStartTimestamp, EvidenceEndTimestamp, ObservationUUID, Title, Confidence, SrcIp, SrcIpEnrichmentsInternal, DstIp, DstIpEnrichmentsInternal, DstIpEnrichmentsAnnotationsApplications, DstIpEnrichmentsAnnotationsTags, GeoDistance, SensorIds, EvidenceIQL, Context, Description, Class, Type",
              "size": 0,
              "showAnalytics": true,
              "title": "FNC Observation List",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "exportToExcelOptions": "all",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "rowLimit": 1000,
                "filter": true
              },
              "sortBy": []
            },
            "name": "FNC Observation List"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Observation"
      },
      "name": "Observation"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Detection charts and list tables"
            },
            "name": "text - 0"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "3e9b6847-1b6c-4ba5-87d6-a3d4b0e36046",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 2419200000
                  }
                },
                {
                  "id": "88270ace-134e-4577-b2fd-58b4a7a0cb36",
                  "version": "KqlParameterItem/1.0",
                  "name": "Severity",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ]
                  },
                  "jsonData": "[\n    {\"value\":\"high\", \"label\":\"High\"},\n    {\"value\":\"moderate\", \"label\":\"Moderate\"},\n    {\"value\":\"low\", \"label\":\"Low\"}\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "value": [
                    "value::all"
                  ]
                },
                {
                  "id": "cab3ce23-4ea0-4565-a7fb-2009f888198f",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "query": "FncEventsDetections_CL\n| summarize by rule_category_s\n| order by rule_category_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 7"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "\nFortinet_FortiNDR_Cloud\n| where Type == 'FncEventsDetections_CL'\n| where Created between ({TimeRange:start} .. {TimeRange:end})\n| where Severity in ({Severity})\n| where isempty('{Category}') or (Category == '{Category}')\n| summarize Count = count() by Severity, Confidence,  bin(Created, 1d)\n| render barchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Detection Severity Chart",
              "color": "lightBlue",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "exportToExcelOptions": "all",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "moderate",
                    "color": "orange"
                  },
                  {
                    "seriesName": "low",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "high",
                    "color": "redBright"
                  }
                ]
              }
            },
            "name": "query - 8",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "823503cb-f18b-400c-b28a-185e5b094784",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 2419200000
                  }
                },
                {
                  "id": "dcf98b77-872d-497d-ba50-3fd601459d96",
                  "version": "KqlParameterItem/1.0",
                  "name": "Confidence",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\n    {\"value\":\"high\", \"label\":\"High\"},\n    {\"value\":\"moderate\", \"label\":\"Moderate\"},\n    {\"value\":\"low\", \"label\":\"Low\"}\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "value": [
                    "value::all"
                  ]
                },
                {
                  "id": "1e1ec5ae-3c72-450b-b97b-4e2c8cf779f2",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "query": "FncEventsDetections_CL\n| summarize by rule_category_s\n| order by rule_category_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 7 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsDetections_CL'\n| where Created between ({TimeRange:start} .. {TimeRange:end})\n| where Confidence in ({Confidence})\n| where isempty('{Category}') or (Category == '{Category}')\n| summarize Count = count() by Confidence,  bin(Created, 1d)\n| render barchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Detection Confidence Chart",
              "color": "lightBlue",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart",
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "moderate",
                    "color": "orange"
                  },
                  {
                    "seriesName": "low",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "high",
                    "color": "redBright"
                  }
                ]
              }
            },
            "name": "query - 8 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a613556b-fcd7-440a-af79-47b839e8f76b",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 604800000
                  }
                },
                {
                  "id": "9196914a-cd13-4897-8d8f-2e497721452a",
                  "version": "KqlParameterItem/1.0",
                  "name": "Severity",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ]
                  },
                  "jsonData": "[\n    {\"value\":\"high\", \"label\":\"High\"},\n    {\"value\":\"moderate\", \"label\":\"Moderate\"},\n    {\"value\":\"low\", \"label\":\"Low\"}\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "value": [
                    "value::all"
                  ]
                },
                {
                  "id": "0b5bbec6-76d8-422c-89a4-95162c9300cb",
                  "version": "KqlParameterItem/1.0",
                  "name": "Confidence",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\n    {\"value\":\"high\", \"label\":\"High\"},\n    {\"value\":\"moderate\", \"label\":\"Moderate\"},\n    {\"value\":\"low\", \"label\":\"Low\"}\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all"
                },
                {
                  "id": "876e2140-cacb-4d7c-88ed-354ecd7e86a2",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "query": "FncEventsDetections_CL\n| summarize by rule_category_s\n| order by rule_category_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                },
                {
                  "id": "876e2140-cacb-4d7c-88ed-354ecd7e86a2",
                  "version": "KqlParameterItem/1.0",
                  "name": "RuleNames",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "FncEventsDetections_CL\n| summarize by rule_name_s\n| order by rule_name_s asc",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 7 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Fortinet_FortiNDR_Cloud\n| where Type == 'FncEventsDetections_CL'\n| where Created between ({TimeRange:start} .. {TimeRange:end})\n| where Severity in ({Severity})\n| where Confidence in ({Confidence})\n| where Rule_Name in ({RuleNames})\n| where isempty('{Category}') or (Category == '{Category}')\n| sort by Created desc\n| project TimeGenerated, UUID, Device_IP, Event_Count, Indicators, First_Seen, Last_Seen, Created, Updated, Status, Muted, Mute_Comment, Severity, Confidence,  Resolution, Date_Resolved, Account_UUID, Sensor_ID, Rule_Name, Rule_UUID, Rule_Muted, Category, Type\n\n",
              "size": 0,
              "showAnalytics": true,
              "title": "FNC Detection List",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "exportToExcelOptions": "all",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "rowLimit": 1000,
                "filter": true
              },
              "sortBy": [],
              "tileSettings": {
                "showBorder": false
              }
            },
            "name": "query - 6"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Detection"
      },
      "name": "Detection"
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/3f4a7f4a-5e8a-408f-8b5b-c8bfeb836628/resourcegroups/fortindrcloud/providers/microsoft.operationalinsights/workspaces/fortindrcloud-dev"
  ],
  "fromTemplateId": "sentinel-FortiNdrCloud",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}